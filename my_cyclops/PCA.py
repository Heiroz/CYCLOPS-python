from sklearn.decomposition import PCA

def create_eigengenes(expression_scaled, n_components=50):
    print("进行PCA变换...")
    pca = PCA(n_components=n_components)
    components = pca.fit_transform(expression_scaled)
    explained_variance = pca.explained_variance_ratio_
    
    return components, pca, explained_variance

class SimplePCATransformer:
    def __init__(self, pca):
        self.pca = pca
    
    def transform(self, X_scaled):
        return self.pca.transform(X_scaled)